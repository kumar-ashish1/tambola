{"ast":null,"code":"import _slicedToArray from\"/Users/ashish/Documents/tambola2/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _classCallCheck from\"/Users/ashish/Documents/tambola2/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/ashish/Documents/tambola2/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/ashish/Documents/tambola2/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/ashish/Documents/tambola2/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import*as React from\"react\";import{Component}from\"react\";import HostTicket from\"./HostTicket\";import Joyride from\"react-joyride\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var MultipleHostTicket=/*#__PURE__*/function(_Component){_inherits(MultipleHostTicket,_Component);var _super=_createSuper(MultipleHostTicket);function MultipleHostTicket(props){var _this;_classCallCheck(this,MultipleHostTicket);_this=_super.call(this,props);_this.hasWalkthroughShown=void 0;_this.walkThroughSteps=[{target:\".host-ticket\",content:\"This is the player's ticket. They think they have won this award. Your task is to check the 'crossed' numbers on this ticket and tell the players if this is a valid win or a Bogey!\",disableBeacon:true,placement:\"bottom\",disableOverlay:true}];_this.removeTicket=function(idWinCall){var newState=_this.state.ticketFromPlayers;delete newState[idWinCall];_this.setState({ticketFromPlayers:newState});// check if there is no HostTicket then enable the generate new button and emit event for 'Waiting' component\nif(Object.keys(newState).length===0&&newState.constructor===Object){var generateNewButton=document.querySelector(\"button.new-number\");generateNewButton.disabled=false;generateNewButton.classList.remove(\"disabled-button\");_this.props.socket.emit(\"hostCompletedChecking\");}};_this.state={ticketFromPlayers:{},runWalkthrough:false};// hasWalkthrough shown handles this logic: \n// if player tickets become zero then the tutorial is shown and hasWalkthrough shown\n// becomes true and tutorial is never shown. This is the case when in props we receive\n// showWalkthrough as true. If it is false then we just change hasWalkthrough shown to be\n// true and then the walkThrough never playes\n_this.hasWalkthroughShown=!_this.props.showWalkthrough;return _this;}_createClass(MultipleHostTicket,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.props.socket.on(\"callWinToHost\",function(callWinObj){// updating values\nvar newTicketsState=_this2.state.ticketFromPlayers;var runWalkthrough=_this2.hasWalkthroughShown?false:true;// JS does not support keys to be objects, so this is easy workaround for the\n// case when same user made 2 different win calls at the same time; The key\n// is a string concatenation of id and wintype\nnewTicketsState[callWinObj.user.id+callWinObj.callWinType]=callWinObj;_this2.setState({ticketFromPlayers:newTicketsState,runWalkthrough:runWalkthrough});// Disable the generate new button\nvar generateNewButton=document.querySelector(\"button.new-number\");generateNewButton.disabled=true;generateNewButton.classList.add(\"disabled-button\");});}},{key:\"render\",value:function render(){var ticketComponents=[];for(var _i=0,_Object$entries=Object.entries(this.state.ticketFromPlayers);_i<_Object$entries.length;_i++){var _Object$entries$_i=_slicedToArray(_Object$entries[_i],2),key=_Object$entries$_i[0],value=_Object$entries$_i[1];var ticket=/*#__PURE__*/_jsx(HostTicket,{socket:this.props.socket,callWinObj:value,removeTicketFromHost:this.removeTicket},key);ticketComponents.push(ticket);}return/*#__PURE__*/_jsxs(_Fragment,{children:[ticketComponents,/*#__PURE__*/_jsx(Joyride,{steps:this.walkThroughSteps,run:this.state.runWalkthrough,continuous:true,disableOverlayClose:true,showProgress:true,showSkipButton:true,spotlightClicks:true,styles:{options:{zIndex:10000,primaryColor:\"#0e141f\",textColor:\"#0e141f\"}}})]});}}]);return MultipleHostTicket;}(Component);export default MultipleHostTicket;","map":{"version":3,"names":["React","Component","HostTicket","Joyride","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","MultipleHostTicket","_Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","hasWalkthroughShown","walkThroughSteps","target","content","disableBeacon","placement","disableOverlay","removeTicket","idWinCall","newState","state","ticketFromPlayers","setState","Object","keys","length","constructor","generateNewButton","document","querySelector","disabled","classList","remove","socket","emit","runWalkthrough","showWalkthrough","_createClass","key","value","componentDidMount","_this2","on","callWinObj","newTicketsState","user","id","callWinType","add","render","ticketComponents","_i","_Object$entries","entries","_Object$entries$_i","_slicedToArray","ticket","removeTicketFromHost","push","children","steps","run","continuous","disableOverlayClose","showProgress","showSkipButton","spotlightClicks","styles","options","zIndex","primaryColor","textColor"],"sources":["/Users/ashish/Documents/tambola2/frontend/src/components/MultipleHostTickets.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { Component } from \"react\";\nimport { callWin } from \"./Player\";\nimport HostTicket from \"./HostTicket\";\nimport Joyride, { Step } from \"react-joyride\";\nimport Board from \"./Board\";\n\ninterface MultipleHostTicketProps {\n  socket: any;\n  showWalkthrough: boolean;\n}\n\ninterface MultipleHostTicketState {\n  ticketFromPlayers: { [id: string]: callWin };\n  runWalkthrough: boolean;\n}\n\nclass MultipleHostTicket extends Component<\n  MultipleHostTicketProps,\n  MultipleHostTicketState\n> {\n  hasWalkthroughShown: boolean;\n  constructor(props: MultipleHostTicketProps) {\n    super(props);\n    this.state = { ticketFromPlayers: {}, runWalkthrough: false };\n    \n    // hasWalkthrough shown handles this logic: \n    // if player tickets become zero then the tutorial is shown and hasWalkthrough shown\n    // becomes true and tutorial is never shown. This is the case when in props we receive\n    // showWalkthrough as true. If it is false then we just change hasWalkthrough shown to be\n    // true and then the walkThrough never playes\n    this.hasWalkthroughShown = !this.props.showWalkthrough;\n  }\n\n  walkThroughSteps: Step[] = [\n    {\n      target: \".host-ticket\",\n      content:\n        \"This is the player's ticket. They think they have won this award. Your task is to check the 'crossed' numbers on this ticket and tell the players if this is a valid win or a Bogey!\",\n      disableBeacon: true,\n      placement: \"bottom\",\n      disableOverlay: true,\n    },\n  ];\n\n  componentDidMount() {\n    this.props.socket.on(\"callWinToHost\", (callWinObj: callWin) => {\n      // updating values\n      let newTicketsState = this.state.ticketFromPlayers;\n      let runWalkthrough: boolean = this.hasWalkthroughShown ? false : true;\n\n      // JS does not support keys to be objects, so this is easy workaround for the\n      // case when same user made 2 different win calls at the same time; The key\n      // is a string concatenation of id and wintype\n      newTicketsState[callWinObj.user.id + callWinObj.callWinType] = callWinObj;\n      this.setState({\n        ticketFromPlayers: newTicketsState,\n        runWalkthrough: runWalkthrough,\n      });\n      // Disable the generate new button\n      let generateNewButton = document.querySelector(\n        \"button.new-number\"\n      ) as HTMLInputElement;\n      generateNewButton.disabled = true;\n      generateNewButton.classList.add(\"disabled-button\");\n    });\n  }\n\n  removeTicket = (idWinCall: string) => {\n    let newState = this.state.ticketFromPlayers;\n    delete newState[idWinCall];\n    this.setState({ ticketFromPlayers: newState });\n\n    // check if there is no HostTicket then enable the generate new button and emit event for 'Waiting' component\n    if (Object.keys(newState).length === 0 && newState.constructor === Object) {\n      let generateNewButton = document.querySelector(\n        \"button.new-number\"\n      ) as HTMLInputElement;\n      generateNewButton.disabled = false;\n      generateNewButton.classList.remove(\"disabled-button\");\n      this.props.socket.emit(\"hostCompletedChecking\");\n    }\n  };\n\n  render() {\n    let ticketComponents = [];\n    for (const [key, value] of Object.entries(this.state.ticketFromPlayers)) {\n      let ticket = (\n        <HostTicket\n          key={key}\n          socket={this.props.socket}\n          callWinObj={value}\n          removeTicketFromHost={this.removeTicket}\n        />\n      );\n      ticketComponents.push(ticket);\n    }\n    return (\n      <>\n        {ticketComponents}\n        <Joyride\n          steps={this.walkThroughSteps}\n          run={this.state.runWalkthrough}\n          continuous={true}\n          disableOverlayClose={true}\n          showProgress={true}\n          showSkipButton={true}\n          spotlightClicks={true}\n          styles={{\n            options: {\n              zIndex: 10000,\n              primaryColor: \"#0e141f\",\n              textColor: \"#0e141f\",\n            },\n          }}\n        />\n      </>\n    );\n  }\n}\n\nexport default MultipleHostTicket;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}